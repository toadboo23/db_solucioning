# PostgreSQL Configuration for Production
# Configuración segura para producción

# Configuración de conexiones
listen_addresses = '*'           # Aceptar conexiones de cualquier host
port = 5432                              # Puerto estándar
max_connections = 100                    # Máximo de conexiones simultáneas

# Autenticación y seguridad
password_encryption = scram-sha-256      # Encriptación moderna
ssl = on                                 # SSL habilitado para seguridad
ssl_cert_file = '/etc/ssl/certs/ssl-cert-snakeoil.pem'
ssl_key_file = '/etc/ssl/private/ssl-cert-snakeoil.key'

# Configuración de memoria
shared_buffers = 256MB                   # Buffer compartido
effective_cache_size = 2GB               # Memoria disponible para cache
work_mem = 4MB                          # Memoria para operaciones de ordenamiento

# Logging para auditoria
log_statement = 'mod'                    # Log de modificaciones (INSERT, UPDATE, DELETE)
log_min_duration_statement = 1000       # Log de queries que tardan más de 1 segundo
log_connections = on                     # Log de conexiones
log_disconnections = on                  # Log de desconexiones
log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '

# Configuración para backup
wal_level = replica                      # Nivel de WAL para replicación
archive_mode = off                       # Modo archivo desactivado (no se usa PITR)
max_wal_senders = 3                     # Máximo de senders WAL

# Configuración de rendimiento
checkpoint_completion_target = 0.9      # Target de checkpoint
wal_buffers = 16MB                      # Buffers WAL
default_statistics_target = 100         # Target de estadísticas 